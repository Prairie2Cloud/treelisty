{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "TreeListy Pattern",
  "description": "Schema for TreeListy pattern definitions",
  "type": "object",
  "required": ["key", "name", "icon", "levels", "description"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "URL to this schema for validation"
    },
    "schemaVersion": {
      "type": "integer",
      "const": 1,
      "description": "Pattern schema version (currently 1)"
    },
    "key": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9-]*$",
      "description": "Unique pattern identifier (lowercase, hyphens only)"
    },
    "name": {
      "type": "string",
      "description": "Human-readable pattern name"
    },
    "icon": {
      "type": "string",
      "description": "Emoji icon for the pattern"
    },
    "version": {
      "type": "string",
      "description": "Semver version of this pattern (e.g., '1.0.0')"
    },
    "author": {
      "type": "string",
      "description": "Pattern author name or organization"
    },
    "description": {
      "type": "string",
      "description": "What this pattern is for and when to use it"
    },
    "levels": {
      "type": "object",
      "required": ["root"],
      "properties": {
        "root": {
          "type": "string",
          "description": "Label for root node (e.g., 'Project')"
        },
        "phase": {
          "type": "string",
          "description": "Label for phase/top-level nodes (e.g., 'Phase')"
        },
        "item": {
          "type": "string",
          "description": "Label for item/mid-level nodes (e.g., 'Item')"
        },
        "subtask": {
          "type": "string",
          "description": "Label for subtask/leaf nodes (e.g., 'Task')"
        }
      },
      "description": "Hierarchical level labels for this pattern"
    },
    "phaseSubtitles": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Suggested default names for phases (e.g., ['Q1', 'Q2', 'Q3'])"
    },
    "types": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["value", "label"],
        "properties": {
          "value": {
            "type": "string",
            "description": "Internal value for this type"
          },
          "label": {
            "type": "string",
            "description": "Display label for this type"
          }
        }
      },
      "description": "Available node types for this pattern"
    },
    "defaultAIConfig": {
      "type": "object",
      "properties": {
        "tone": {
          "type": "string",
          "enum": ["neutral", "critical", "enthusiastic", "socratic"],
          "description": "Default AI tone for this pattern"
        },
        "verbosity": {
          "type": "string",
          "enum": ["concise", "balanced", "verbose"],
          "description": "Default AI output style"
        },
        "creativity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Default creativity level (0.0-1.0)"
        },
        "dialecticMode": {
          "type": "boolean",
          "description": "Whether to enable dialectic mode by default"
        }
      },
      "description": "Default AI configuration for this pattern"
    },
    "sortOptions": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["value", "label", "field", "order", "type"],
        "properties": {
          "value": {
            "type": "string",
            "description": "Internal value for this sort option"
          },
          "label": {
            "type": "string",
            "description": "Display label for this sort option"
          },
          "field": {
            "type": "string",
            "description": "Field name to sort by"
          },
          "order": {
            "type": "string",
            "enum": ["asc", "desc"],
            "description": "Sort order (ascending or descending)"
          },
          "type": {
            "type": "string",
            "description": "Field type (text, number, date, leadtime, etc.)"
          }
        }
      },
      "description": "Available sort options for tree nodes in this pattern"
    },
    "fields": {
      "type": "object",
      "description": "Custom field definitions for this pattern. Keys are field names, values are field configs.",
      "patternProperties": {
        "^[a-zA-Z_][a-zA-Z0-9_]*$": {
          "type": "object",
          "properties": {
            "label": {
              "type": "string",
              "description": "Display label for this field"
            },
            "type": {
              "type": "string",
              "enum": ["text", "number", "date", "textarea", "select"],
              "description": "Field input type"
            },
            "placeholder": {
              "type": "string",
              "description": "Placeholder text for text inputs"
            },
            "helpText": {
              "type": "string",
              "description": "Help text shown with the field"
            },
            "min": {
              "type": "number",
              "description": "Minimum value for number fields"
            },
            "max": {
              "type": "number",
              "description": "Maximum value for number fields"
            },
            "step": {
              "type": "number",
              "description": "Step value for number fields"
            },
            "options": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "value": { "type": "string" },
                  "label": { "type": "string" }
                }
              },
              "description": "Options for select fields"
            }
          }
        }
      },
      "additionalProperties": {
        "anyOf": [
          { "type": "object" },
          { "type": "boolean" }
        ]
      }
    }
  }
}
