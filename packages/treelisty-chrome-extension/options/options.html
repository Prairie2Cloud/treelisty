<!DOCTYPE html>
<html>
<head>
  <title>TreeListy Screen Awareness - Settings</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #e0e0e0;
      padding: 24px;
      min-width: 400px;
    }

    h1 {
      font-size: 20px;
      margin-bottom: 8px;
      color: #8b5cf6;
    }

    .subtitle {
      font-size: 13px;
      color: #888;
      margin-bottom: 24px;
    }

    .section {
      background: #252540;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #a5a5c0;
    }

    label {
      display: block;
      font-size: 13px;
      margin-bottom: 6px;
      color: #a5a5c0;
    }

    input[type="text"],
    input[type="number"] {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #3d3d5c;
      border-radius: 8px;
      background: #1a1a2e;
      color: #e0e0e0;
      font-size: 14px;
      margin-bottom: 12px;
    }

    input:focus {
      outline: none;
      border-color: #8b5cf6;
    }

    .status {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 12px;
    }

    .status.connected {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .status.disconnected {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    .status.connected .status-dot {
      background: #10b981;
    }

    .status.disconnected .status-dot {
      background: #ef4444;
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: #8b5cf6;
      color: white;
    }

    .btn-primary:hover {
      background: #7c3aed;
    }

    .btn-secondary {
      background: #3d3d5c;
      color: #e0e0e0;
    }

    .btn-secondary:hover {
      background: #4d4d6c;
    }

    .button-row {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    .help-text {
      font-size: 12px;
      color: #666;
      margin-top: 4px;
    }

    .permissions {
      margin-top: 16px;
    }

    .permission-item {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      padding: 8px 0;
      border-bottom: 1px solid #3d3d5c;
    }

    .permission-item:last-child {
      border-bottom: none;
    }

    .permission-icon {
      font-size: 16px;
    }

    .permission-name {
      font-weight: 500;
      font-size: 13px;
    }

    .permission-desc {
      font-size: 12px;
      color: #888;
    }

    .saved-toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #10b981;
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .saved-toast.visible {
      opacity: 1;
    }
  </style>
</head>
<body>
  <h1>TreeListy Screen Awareness</h1>
  <p class="subtitle">Connect TreeListy to see your browser for AI-assisted context</p>

  <div class="section">
    <div class="section-title">Connection Status</div>
    <div id="status" class="status disconnected">
      <div class="status-dot"></div>
      <span id="status-text">Checking...</span>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Bridge Configuration</div>

    <label for="port">Bridge Port</label>
    <input type="number" id="port" placeholder="3456" value="3456">
    <p class="help-text">Default: 3456. Change only if MCP bridge uses a different port.</p>

    <label for="token">Pairing Token</label>
    <input type="text" id="token" placeholder="treelisty-local">
    <p class="help-text">Found in the MCP bridge console output when it starts.</p>

    <div class="button-row">
      <button class="btn-primary" id="save">Save Settings</button>
      <button class="btn-secondary" id="reconnect">Reconnect</button>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Permissions Explained</div>
    <div class="permissions">
      <div class="permission-item">
        <span class="permission-icon">ðŸ“¸</span>
        <div>
          <div class="permission-name">activeTab</div>
          <div class="permission-desc">Capture screenshot of current tab only when you click</div>
        </div>
      </div>
      <div class="permission-item">
        <span class="permission-icon">ðŸ“„</span>
        <div>
          <div class="permission-name">scripting</div>
          <div class="permission-desc">Extract text content from pages for AI context</div>
        </div>
      </div>
      <div class="permission-item">
        <span class="permission-icon">ðŸ’¾</span>
        <div>
          <div class="permission-name">storage</div>
          <div class="permission-desc">Save your pairing token locally</div>
        </div>
      </div>
    </div>
  </div>

  <div class="saved-toast" id="toast">Settings saved!</div>

  <script src="options.js"></script>
</body>
</html>
